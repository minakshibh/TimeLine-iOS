Minor bug fixes and improved stability.